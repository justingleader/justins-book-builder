# Quarto Book Builder: Markdown Formatting Guide

This guide covers the proper formatting of markdown for the Quarto Book Builder system.

## Basic Structure

### Chapter Frontmatter
```markdown
---
title: "Chapter Title"
author: "Author Name"
description: "Brief chapter description"
date: "2025-04-07"
---
```

### Headings
```markdown
# Chapter Title (H1)
## Section Title (H2)
### Subsection Title (H3)
```

## Special Features

### AI Image Generation

#### Code Block Syntax
```markdown
```{.openai-image}
prompt: "A serene mountain landscape at sunset with a lake reflecting the orange sky"
size: "1024x1024"  # Optional
quality: "standard"  # Optional
style: "vivid"  # Optional
```
```

#### Inline Syntax
```markdown
{{image: A digital painting of a castle on a hill at sunset, with golden skies}}
```

### Custom Templates

#### Featured Quote
```markdown
::: featured-quote
"This is the quote text."
**— Author Name**
:::
```

#### Callout
```markdown
::: callout
title: Note Title
type: info  # Options: info, warning, danger, success

Callout content goes here.
:::
```

#### Figure
```markdown
::: figure
src: path/to/image.png
caption: Figure caption
description: Optional longer description
credit: Image credit information
:::
```

#### Code Block with Caption
```markdown
::: code-block
title: Example Code
language: python

def hello_world():
    print("Hello, world!")
:::
```

#### Listicle
```markdown
::: listicle
title: Top 3 Points

1. First important point
2. Second important point 
3. Third important point
:::
```

## Configuration Files

The build process uses two main configuration files:

### config.yaml
Contains OpenAI API keys, image directories, and custom template definitions.

### _quarto.yml
Defines the book structure, chapters, and output formats.

## Common Issues

- Ensure proper indentation in template blocks
- Check image paths for PDF vs HTML/EPUB formats
- Verify template names match those defined in config.yaml

## Directory Structure

The workspace is organized to manage multiple book projects and shared resources:

```
/
├── common/                 # Shared resources across all projects
│   ├── filters/            # Reusable Quarto Lua filters
│   └── assets/             # Shared images, CSS, etc.
├── docs/                   # Split documentation files (generated by split_docs.py)
│   └── draft/              # Raw, large documentation files (e.g., source before splitting)
├── logs/                   # Log files from build processes or scripts
├── projects/               # Contains individual book projects
│   └── [your-book-name]/   # Directory for a specific book
│       ├── input/            # Raw source materials (e.g., .md chapters, images)
│       ├── draft-1/          # Folder for the first draft iteration
│       │   ├── working/      # Active Quarto project files (.qmd, _quarto.yml)
│       │   └── output/       # Rendered output for this draft (PDF, HTML)
│       ├── draft-2/          # Folder for the second draft iteration
│       │   ├── working/
│       │   └── output/
│       └── ...               # Additional drafts
├── quarto_book_builder/    # Source code for the builder tool
├── tests/                  # Tests for the builder tool
├── temp/                   # Temporary files (e.g., downloads)
├── .venv/                  # Python virtual environment
├── _build/                 # Quarto build output directory (often project-specific)
├── .gitignore              # Specifies intentionally untracked files
├── README.md               # This file
├── requirements.txt        # Python package requirements
├── setup.py                # Python package setup script
├── split_docs.py           # Script to split large markdown files by H2 headers
└── test_app.py             # Test application script
```

**Brand Assets Directory Structure:**

The `brand-assets/` directory contains all brand-related resources and guidelines:

```
brand-assets/
├── images/                 # Brand visual assets
│   ├── logos/             # Company logos in various formats
│   ├── color-swatches/    # Brand color palette visual references
│   └── photography/       # Brand photography guidelines and examples
├── json/                  # Machine-readable brand specifications
│   ├── color_palette.json     # Color definitions and usage
│   ├── typography.json        # Font specifications
│   ├── layout_spacing.json    # Layout and spacing rules
│   ├── logo_usage.json       # Logo usage guidelines
│   └── imagery_photography.json # Photography style guide
├── markdown/              # Human-readable brand guidelines
│   ├── stack_intelligence_style_guide.md  # Main style guide
│   ├── color_palette_specifications.md    # Color usage details
│   ├── typography_guidelines.md           # Typography rules
│   ├── layout_spacing_principles.md       # Layout guidelines
│   ├── logo_guidelines.md                 # Logo usage rules
│   └── imagery_photography_guidelines.md  # Photography guidelines
└── templates/            # Brand-compliant document templates
    ├── b2b_executive_ebook_template.md    # Executive ebook template
    └── salesforce_ae_ebook_template.md    # Sales ebook template
```

**Notes on `docs/` Directory:**

*   The `docs/draft/` subdirectory is used to store original, large documentation files (like `quarto-docs-full.md`).
*   The `split_docs.py` script reads files from `docs/draft/`, splits them based on Level 2 Markdown headers (`##`), and writes the resulting smaller files directly into the main `docs/` directory.

**Workflow:**

1.  Place raw manuscript files (e.g., `.md` chapters, images) into `projects/[your-book-name]/input/`.
2.  Run the input processor to move files to draft and delete input files:
   ```bash
   python process_input.py [your-book-name]
   ```
   This will:
   - Copy files from `input/` to `draft-1/working/`
   - Delete the files from `input/` after successful processing
3.  For a new draft (e.g., `draft-1`), create the `draft-1/working/` and `draft-1/output/` subdirectories if they don't exist.
4.  Set up the `_quarto.yml` file within `draft-1/working/`.
   - Files can remain as `.md` format - Quarto supports both `.md` and `.qmd` files
   - The `_quarto.yml` file should reference the correct file extensions in its chapters section
5.  Work on the book within the `draft-1/working/` directory.
6.  Render the book using Quarto, directing the output (if possible) or moving it to `draft-1/output/`.
7.  For subsequent drafts, repeat steps 2-6 (e.g., for `draft-2`).
8.  Shared filters or assets (like CSS themes) should be placed in the `common/` directory and referenced using relative paths from the `_quarto.yml` file in a draft's `working` directory (e.g., `../../common/filters/myfilter.lua`).
